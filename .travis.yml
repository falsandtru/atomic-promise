os: linux
dist: xenial
language: node_js
jobs:
  include:
  - os: linux
    node_js: 12
  - os: osx
    node_js: 12
addons:
  chrome: stable
  firefox: latest
services:
- xvfb
script:
- npm run ci
before_deploy:
- sed -i 's/"private":\ true/"private":\ false/' package.json
- sed -i -E 's/^dist\/?.*$//' .gitignore
deploy:
  provider: npm
  edge: true
  email:
    secure: TQ/8RCe2sI7bwkR2pPQDADIazItkNWK56PyE9jPZjbDs3OIuFCEzycFoRPjfk+6vjWDExUKw5E2x0+/xf0m5aUhe7xjW6pu8DvIMVbeGGWFJgxAWMQ/IZngSITLFnvAu4A+B6K4Xzx5QDsPAve1NXrprrfOcxxylLRheCihH+7TCTMknucBE+dZaE2QjRjtZYGY94nrZzWrgdz9+u45dwzWoVeRwz+RVnaH6/YnFnogKuOSIBEnGxoVx9Pg5m+91wrDtv60PCDAvIGzngGZwsQuWS3DIY/LBgJFj1/m/qtT1Q7WHfkxV2boY8U60GHb741Q3pW8tyHY2VTuLOyuSyKEsAYzA52RP4SYZTgsYZlqkY+VkBqYEIDmpQnYG6uyWOxMpuf+sS5nLmy55Y6TJty5H9PxuzA8W980CtPdR7ZGkqfkF1oFpzILwpE4/EZWcL9YeMa6NBIZX05kfFGAV0euRWhnPKwOgJOs18GpAxo3FkHyhKkyNoQyvTlUOIQ6aiBJ2PoMsJZjmAsktMGiYKrcORR1skChTkZWCyVOe15TKiQknLZx44zUT7CB02W0FHgxfN0qTKV3nqG0/uDpQ/8cOHmshH0WI4jBFi73D7HSgavPpRYUsZ21lnxCyQYPJABbtU/APAUzrQrHV6P3XlCtvF9xRK1Kkj5pTuqcK1vM=
  api_token:
    secure: "DhgB029SvPZig340754ZLMN1AVzgDNH5QdTLNdIJmNL0BTuHyLgeHU4RLI8ltfcnkIFX/8CxPg6q1YIIGblIhbtZ0OdXReOYefZqdDvqEQF/c4/M3N+TYzpBwY1xYZb86kGaJFfbzWNQx58QLOYppuJmgyUOU7JQULKfOGkFXrqQw5wageFxspgfmEe4H58r1XK+BgSCEgqim2a66PBEOcUyCQNnW8elcJDxSuo9cY+mxXQ0f8r52/29i7FGrFPSQdse9nOVvZ+hh6Pg3v8RsCygx/EYw/jZHk1qW7lyCoSdKE3316LyOIbue5E9gYFm51CpWDaCfquTKwlXFgnh+2/LGjVL5kTEkbscyoocAI4PdgZSQTKxguIh1Hy6m4ZNvWowZxl6DfyI7pdxnX7TH6M5a2dFp/KdSNzlS29Xi+2UKsrjBlrU1sctb9yCsF2c5UdRJAowiipsxgNSjQYLbBy2H0RUcV+gqMIU9Pn5+pbSSCRwrYN++d/Ijn0fPUhINnv22rg6w+TNDUgbx5zjs+utPI605ccK45lox8A/HXrQdPhtoJisbzF75Kl8f5d1k8U+iQh6r2KHwYO40vU18NwzF6QfwRI+ajQaMNkFFm0muM7kozxVN27W2mfvmP5Rsm09+iGmf063SZK9qTISqclZYphf59ZHtnSNploskFA="
  on:
    node_js: 12
    condition:
    - $TRAVIS_BRANCH = master
    - $TRAVIS_EVENT_TYPE = push
    - $TRAVIS_COMMIT_MESSAGE =~ ^v[0-9]+(\.[0-9]+)*($|\n)
    - $TRAVIS_OS_NAME = linux
notifications:
  email:
    recipients:
    - secure: TQ/8RCe2sI7bwkR2pPQDADIazItkNWK56PyE9jPZjbDs3OIuFCEzycFoRPjfk+6vjWDExUKw5E2x0+/xf0m5aUhe7xjW6pu8DvIMVbeGGWFJgxAWMQ/IZngSITLFnvAu4A+B6K4Xzx5QDsPAve1NXrprrfOcxxylLRheCihH+7TCTMknucBE+dZaE2QjRjtZYGY94nrZzWrgdz9+u45dwzWoVeRwz+RVnaH6/YnFnogKuOSIBEnGxoVx9Pg5m+91wrDtv60PCDAvIGzngGZwsQuWS3DIY/LBgJFj1/m/qtT1Q7WHfkxV2boY8U60GHb741Q3pW8tyHY2VTuLOyuSyKEsAYzA52RP4SYZTgsYZlqkY+VkBqYEIDmpQnYG6uyWOxMpuf+sS5nLmy55Y6TJty5H9PxuzA8W980CtPdR7ZGkqfkF1oFpzILwpE4/EZWcL9YeMa6NBIZX05kfFGAV0euRWhnPKwOgJOs18GpAxo3FkHyhKkyNoQyvTlUOIQ6aiBJ2PoMsJZjmAsktMGiYKrcORR1skChTkZWCyVOe15TKiQknLZx44zUT7CB02W0FHgxfN0qTKV3nqG0/uDpQ/8cOHmshH0WI4jBFi73D7HSgavPpRYUsZ21lnxCyQYPJABbtU/APAUzrQrHV6P3XlCtvF9xRK1Kkj5pTuqcK1vM=
    on_success: change
    on_failure: always
