os: linux
dist: xenial
language: node_js
jobs:
  include:
  - os: linux
    node_js: 12
  - os: osx
    node_js: 12
addons:
  chrome: stable
  firefox: latest
services:
- xvfb
script:
- npm run ci
before_deploy:
- sed -i 's/"private":\ true/"private":\ false/' package.json
- sed -i -E 's/^dist\/?.*$//' .gitignore
deploy:
  provider: npm
  edge: true
  email:
    secure: TQ/8RCe2sI7bwkR2pPQDADIazItkNWK56PyE9jPZjbDs3OIuFCEzycFoRPjfk+6vjWDExUKw5E2x0+/xf0m5aUhe7xjW6pu8DvIMVbeGGWFJgxAWMQ/IZngSITLFnvAu4A+B6K4Xzx5QDsPAve1NXrprrfOcxxylLRheCihH+7TCTMknucBE+dZaE2QjRjtZYGY94nrZzWrgdz9+u45dwzWoVeRwz+RVnaH6/YnFnogKuOSIBEnGxoVx9Pg5m+91wrDtv60PCDAvIGzngGZwsQuWS3DIY/LBgJFj1/m/qtT1Q7WHfkxV2boY8U60GHb741Q3pW8tyHY2VTuLOyuSyKEsAYzA52RP4SYZTgsYZlqkY+VkBqYEIDmpQnYG6uyWOxMpuf+sS5nLmy55Y6TJty5H9PxuzA8W980CtPdR7ZGkqfkF1oFpzILwpE4/EZWcL9YeMa6NBIZX05kfFGAV0euRWhnPKwOgJOs18GpAxo3FkHyhKkyNoQyvTlUOIQ6aiBJ2PoMsJZjmAsktMGiYKrcORR1skChTkZWCyVOe15TKiQknLZx44zUT7CB02W0FHgxfN0qTKV3nqG0/uDpQ/8cOHmshH0WI4jBFi73D7HSgavPpRYUsZ21lnxCyQYPJABbtU/APAUzrQrHV6P3XlCtvF9xRK1Kkj5pTuqcK1vM=
  api_token:
    secure: "xJTDizIhRDuEHCx1cWukpQkA/cAvK/QctahZ5WGBtSihv0WhBJxLwcagHpi/BFR+F49/704QoZmw9VlhZVpQBf+IcxWloTo+wj4qU1LWKVjjHp7wxR2CQK8VqgDqTgHm5wviaV4jW0mUVYlKMoJzMSrzmUWhmiC1TuJ991/5mlZ77yGaiIJ+VjvPZKhmXwrvLt1Ks7TZZeOKhY9owTNgF+dKtpZ+5sx41dekLtPrVcMnReJlT39LPwECUakm8dMMirCAZXnBCSE36Km1ZPdNrtnWWNPiht2TPwAWfSJGkZ5ySwKNrOibKP3RqsFrsFdH9W+w8bnO4Fn14Wy0JEuDCwfWP8qChD2jHxmzCnnutUU1CUUGaz6zbHkSS1AiOfjrVv00ZW74kDATlB3OuzNT7SDY0waf7jUfVpU4RXMfhCRP8CBGP6Z9CpwXUY4e9sznq6tremNoQHL/rBfxrEZaBWC58s7rg9xq7NsEZI2p6x8EZX5ROwRbw3HD5WLRlSpHSKu0B19mKJ0b+4ibJgXsGF4L7ehBWRcosu7D8bdxzMfshzt8ovQpoZ1IBPa/FK/zSwLW/6CjuvDpGXJOynp2HIFLaKBF30j+JVzWU+Kq63008MuI+UGeqKJgeK4cWlM3TJfjWgEFaXN0E9nai0n3a5IAEUx5ZEu429hUZnOtOq8="
  on:
    node_js: 12
    condition:
    - $TRAVIS_BRANCH = master
    - $TRAVIS_EVENT_TYPE = push
    - $TRAVIS_COMMIT_MESSAGE =~ ^v[0-9]+(\.[0-9]+)*($|\n)
    - $TRAVIS_OS_NAME = linux
notifications:
  email:
    recipients:
    - secure: TQ/8RCe2sI7bwkR2pPQDADIazItkNWK56PyE9jPZjbDs3OIuFCEzycFoRPjfk+6vjWDExUKw5E2x0+/xf0m5aUhe7xjW6pu8DvIMVbeGGWFJgxAWMQ/IZngSITLFnvAu4A+B6K4Xzx5QDsPAve1NXrprrfOcxxylLRheCihH+7TCTMknucBE+dZaE2QjRjtZYGY94nrZzWrgdz9+u45dwzWoVeRwz+RVnaH6/YnFnogKuOSIBEnGxoVx9Pg5m+91wrDtv60PCDAvIGzngGZwsQuWS3DIY/LBgJFj1/m/qtT1Q7WHfkxV2boY8U60GHb741Q3pW8tyHY2VTuLOyuSyKEsAYzA52RP4SYZTgsYZlqkY+VkBqYEIDmpQnYG6uyWOxMpuf+sS5nLmy55Y6TJty5H9PxuzA8W980CtPdR7ZGkqfkF1oFpzILwpE4/EZWcL9YeMa6NBIZX05kfFGAV0euRWhnPKwOgJOs18GpAxo3FkHyhKkyNoQyvTlUOIQ6aiBJ2PoMsJZjmAsktMGiYKrcORR1skChTkZWCyVOe15TKiQknLZx44zUT7CB02W0FHgxfN0qTKV3nqG0/uDpQ/8cOHmshH0WI4jBFi73D7HSgavPpRYUsZ21lnxCyQYPJABbtU/APAUzrQrHV6P3XlCtvF9xRK1Kkj5pTuqcK1vM=
    on_success: change
    on_failure: always
